파일과 디렉터리
========

## 파일 시스템

- 운영체제가 디스크(파티션) 상에 파일들을 구성하는 방식
- 파일과 디렉터리 집합을 구조적으로 관리하는 체계
- 다양한 형식의 파일 시스템이 존재
- 리눅스는 전체 파일 시스템을 1개의 트리 구조로 관리

## ls 명령

`ls [options] [names]`

- 파일과 서브 디렉터리 목록을 나열하는 명령
- 파일 또는 디렉터리가 가지는 속성도 확인할 수 있음
- ls directory
  - 디렉터리에 존재하는 파일과 서브 디렉터리의 정보를 출력
- ls file
  - 해당 파일의 정보를 출력

### ls 명령 옵션

| 옵션 | 설명 |
|-|-|
| `-a`, `--all` | 모든 파일을 보여준다. 숨김 파일도 보여줌 |
| `-d`, `--directory` | 디렉터리 자체에 대한 정보를 보여줌 |
| `-F`, `--classify` | 우측에 파일의 종류를 알려주는 문자를 붙임 |
| `-l`, `--format=long` | 긴 포맷으로 결과를 보여줌 |
| `-r`, `--reverse` | 역순으로 결과를 보여줌 |
| `-R`, `--recursive` | 재귀적으로 수행. 서브 디렉터리의 내용도 나열 |
| `-S`, `--sort=size` | 파일의 크기 순서로 결과를 보여줌 |
| `-t`, `--sort=time` | 최종 수정 시간 순으로 결과를 보여줌 |


## 파일의 종류

- 정규 파일: 텍스트 파일, 이미지 파일, 또는 실행 파일과 같은 대부분의 파일이 정규 파일
- 디렉터리: 파일이나 서브 디렉터리의 이름과 위치 정보를 가지고 있는 파일. **리눅스에서는 디렉터리도 파일로 취급**
- 심벌릭 링크: 절대경로 또는 상대경로를 사용하여 다른 파일이나 디렉터리를 가리키는 파일
- 블록 디바이스: 블록 단위로 데이터를 읽고 쓸 수 있는 디바이스. 이러한 디바이스에 인터페이스를 제공하는 것이 블록 디바이스 파일. 하드디스크, CD-ROM 등
- 문자 디바이스: 한 번에 한 문자(바이트)씩 데이터를 주고받을 수 있는 디바이스. 시리얼 포트, 병렬 포트, 터미널 등
- 파이프 디바이스: 프로세스 간 통신을 위한 특수한 파일. 문자 디바이스와 유사하나 실제 디바이스와 연결되는 것이 아니고 입력을 요구하느 ㄴ프로세스와 출력을 제공하는 프로세스와 연결됨. mkfifo 명령을 사용하여 만들 수 있음
- 소켓 디바이스: 소켓은 한 호스트 안에서 프로세스 간 통신의 목적으로 자주 사용되는 인터페이스. 소켓 파일은 Unix domain socket을 표현하며 바이트 스트림 외에 데이터그램 전송도 가능


## file 명령

- 파일의 유형을 확인하는 명령어
- 리눅스에서 파일의 이름이나 확장자가 파일의 형식이나 내용을 반영하는 것은 아님


## pwd 명령

- print working directory
- 현재 작업 중인 디렉터리를 확인하는 명령
- 루트 디렉터리를 기준으로 한 절대경로 방식으로 현재 위치를 표시함


## cd 명령

`cd [directory]`

- 현재 작업 디렉터리에서 새로운 작업 디렉터리로 디렉터리를 변경할 때 사용

### 디렉터리 표시에 사용되는 특수 기호와 환경 변수

| 기호/환경 변수 | 설명 |
|-|-|
| $HOME | 홈 디렉터리의 이름을 저장하는 환경 변수 |
| ~ | 셸 명령에서 사용할 때 홈 디렉터리를 의미하는 기호 |
| . | 현재 작업 디렉터리를 의미하는 기호 | 
| .. | 현재 작업 디렉터리의 부모 디렉터리를 의미하는 기호 |
| $PWD | 현재 작업 디렉터리를 저장한 환경 변수 |
| $OLDPWD | 현재 작업 디렉터리의 이전 작업 디렉터리를 저장한 환경 변수 |


## mkdir 명령

`mkdir [options] directories`

- 1개 혹은 여러 개의 디렉터리를 만드는 명령
- 부모 디렉터리의 쓰기 권한을 가지고 있어야 그곳에 디렉터리를 만들 수 있음
- 만들고자 하는 최종 디렉터리의 부모 디렉터리가 존재하지 않는 경우 명령이 수행되지 않는데, 이때 -p 옵션을 사용하면 그에 필요한 모든 디렉터리를 생성함

## mkdir 명령 옵션

| 옵션 | 설명 |
|-|-|
| -p | 필요한 경우 생성을 원하는 디렉터리의 상위 디렉터리를 만든다 |
| -m | 디렉터리를 만들면서 접근권한을 설정한다 |


## rmdir 명령

- 디렉터리를 삭제하는 명령
- 비어 있는 디렉터리만 삭제 가능


## cp 명령

`cp [options] file1 file2` 혹은 `cp [options] files directory`

- 파일이나 디렉터리를 복사하는 명령
- 현재 디렉터리를 기준으로 복사가 이루어지며, 해당 파일이 이미 존재한다면 덮어쓰기가 수행됨
- 여러 개의 파일을 하나의 디렉터리에 같은 이름으로 복사하는 경우 마지막 인자를 디렉터리로 설정

### cp 명령 옵션

| 옵션 | 설명 |
|-|-|
| -a | 소유자, 접근 권한, 시간 정보 등 파일의 모든 속성을 그대로 유지하면서 복사 |
| -i | 대상 파일을 덮어쓰기 전에 확인 과정을 거침 |
| -r | 디렉터리를 복사할 때 모든 내용을 재귀적으로 복사함. 디렉터리를 복사할 때 해당 옵션(혹은 -a)이 필요 |
| -u | 대상 파일이 이미 존재하는 경우, 원본 파일이 더 최근 것이어야 복사가 이루어진다 |


## mv 명령

`mv [options] sources target` 혹은 `mv [options] files directory`

- 파일(또는 디렉터리)의 이름을 변경하거나 파일(또는 디렉터리)을 다른 디렉터리로 이동시키는 명령
- mv 명령의 사용법은 cp 명령과 유사

### mv 명령 옵션

| 옵션 | 설명 |
|-|-|
| -i | 대상 파일이 이미 존재하는 경우 덮어쓰기 전에 물어봄 |
| -u | 디렉터리에 있는 파일이 다른 디렉터리로 이동될 때 대상 파일이 이미 존재하는 경우 원본 파일이 더 최근 것이어야 이동이 이루어진다 |
| -v | 이동이 이루어지면서 알림 메시지를 출력 |


## rm 명령

`rm [options] files`

- 파일 또는 디렉터리를 삭제할 때 사용하는 명령
- 리눅스에서 파일을 삭제한 후 복구하는 명령은 없으므로 파일을 삭제할 때는 신중해야 한다

### rm 명령 옵션

| 옵션 | 설명 |
|-|-|
| -i | 기존 파일을 삭제하기 전에 확인을 위해 물어본다. 삭제되는 파일마다 물어본다 |
| -r | 디렉터리를 재귀적으로 삭제. 디렉터리가 가지는 서브 디렉터리까지 모두 삭제 |
| -f | 물어보지 않고 무조건 삭제. 존재하지 않는 파일을 삭제하는 경우에는 무시. -i 옵션에 우선함 |
| -v | 삭제를 수행하면서 알림 메시지를 출력 |


## 접근 권한

| 접근 권한 | 파일 | 디렉터리 |
|-|-|-|
| 읽기(r) | 파일의 내용을 볼 수 있다 | 디렉터리에 어떤 파일과 서브 디렉터리가 있는지 목록을 볼 수 있다 |
| 쓰기 | 파일의 내용을 바꿀 수 있고 파일의 이름을 변경하거나 파일을 삭제할 수 있다 | 디렉터리에 파일이나 서브 디렉터리를 만들 수 있고, 파일과 서브 디렉터리를 삭제할 수 있다 |
| 실행 | 파일을 실행할 수 있다 | 디렉터리 또는 서브 디렉터리로 cd 명령을 사용하여 이동할 수 있고, 디렉터리에서 프로그램을 실행시킬 수 있다. 또 파일의 메타 정보에 접근할 수 있다 |


`rw-rw-r--`

- 리눅스에서는 권한이 없는 사용자가 다른 사람의 사적인 파일이나 디렉터리에 접근하는 것을 막기 위해 파일이나 디렉터리에는 적절한 접근 권한을 설정할 수 있다
- 9개의 비트를 사요앟여 파일이나 디렉터리에 소유자(u), 그룹(g), 기타(o) 의 세 가지 부류 각각에 관해 읽기(r), 쓰기(w), 실행 권한(x)을 설정할 수 있다
  - 9개의 문자가 세 부류에 관한 접근권한을 순서대로 나타냄
  - 권한을 주지 않는 경우에는 -로 표시
- 실제 사용자가 디렉터리를 자유롭게 사용하려면 읽기/쓰기/실행 권한을 모두 가지고 있어야 한다
  - 적어도 읽기/실행 권한은 가지고 있어야 해당 디렉터리로의 이동인 ls -l 명령 등을 수행할 수 있다


## chmod 명령

`chmod [options] mode files`

- 파일의 소유자가 파일의 접근권한을 변경하기 위하여 사용하는 명령
- 세 자리의 8진수를 사용하여 지정하는 8진수 모드와 기호 모드를 사용하는 방법이 있다
- chmod 명령으로 디렉터리의 접근권한을 지정할 때, 해당 디렉터리가 가지고 있는 파일과 서브 디렉터리에도 똑같이 접근권한을 부여하려면 -R 옵션을 사용


### 8진수 모드

`chmod [options] mode files`

- 읽기를 4, 쓰기를 2, 실행을 1로 하여 각 부류별 8진수를 지정하는 방법
- 세 자리 8진수를 사용하는 방법은 접근권한 전체를 한꺼번에 변경시키는 방법


### 기호 모드

| 대상 | 연산 | 접근권한 |
|-|-|-|
| u(소유자) | +(추가) | r(읽기) |
| g(그룹) | -(제거) | w(쓰기) |
| o(기타) | =(지정) | x(실행) |
| a(전체. 기본값) | s(set user ID) |  |

- 위의 3가지 기호를 조합하여 접근 권한을 변경
  - ex) `chmod 751 file` = `chmod u=rwx,g=rx,o=x file`


## umask 명령
 
`umask [-S] [mask]`

- 파일이나 디렉터리에 지정되는 접근권한의 기본값을 정하는 명령
- umask의 설정 명령은 ~/.bash_profile 또는 ~/.bashrc에 앞서 실행되는 셸 스크립트 파일 /etc/bashrc에 작성되어 있다
- 파일의 경우 666에서 현재 umask의 값을 뺀다
- 디렉터리의 경우 777에서 현재 umask의 값을 뺀다


## chown 명령

`chown [options] newowner files`

- root 사용자는 파일이나 디렉터리의 소유자를 다른 계정으로 바꿀 수 있다
- newowner는 UID 또는 /etc/passwd 파일에 나오는 사용자 계정이어야 한다
- 소유자가 생략되면 소유자의 변경이 없는 것이며 그룹이 생략되면 소유주와 같은 그룹으로 정해진다


## ln 명령

`ln [options] sourcename [destname]` 혹은 `ln [options] sourcenames destdirectory`

- 파일을 다른 이름으로 사용할 수 있게 링크를 만드는 명령
- 하드 링크와 심벌릭 링크로 구분됨

### 하드 링크

- 하나의 파일을 2개의 이름으로 사용하기 위해 기존 파일의 새로운 이름을 만드는 것
- `-s` 옵션을 사용하지 않으면 하드 링크로 만들어진다
- 하드 링크를 만들면 원본 파일(또는 하드 링크)의 링크 카운트가 증가
- 실제 원본 파일과 하드 링크는 같으므로 구분이 불가
- 하드 링크를 삭제하면 링크 카운트가 감소. 즉, 사용하던 이름을 사용 못 하게 하는 것
- 다른 파일 시스템에 존재하는 것의 하드 링크를 만들 수 없음

### 심벌릭 링크

- 원본 파일을 가리키는 바로가기 목적의 새로운 파일을 만드는 것
- `-s` 옵션을 사용하면 심벌릭 링크로 만들어진다
- 다른 파일 시스템에 존재하는 파일의 심벌릭 링크를 만들 수 있음
- 심벌릭 링크를 삭제하는 것은 링크만 삭제하는 것
- 원본을 삭제하거나 다른 디렉터리로 이동하면 심벌릭 링크는 의미가 없어짐
- 디렉터리의 경우는 하드 링크를 만들수 없고 심벌릭 링크만 만들 수 있음


## more 명령

`more [options] files`

- 파일의 내용을 화면 단위로 끊어서 보여주는 명령
- 한 화면에 모두 보여 줄 수 없을 때는 화면 맨 아래에 전체 내용 중 몇 퍼센트를 보았는지 나오며 잠시 화면이 멈춤
- 스페이스 바를 누르면 다음 화면으로 이동
- q를 누르면 more 명령이 종료됨

### more 명령 옵션


| 옵션 | 설명 |
|-|-|
| -num | num개의 행을 단위로 하여 보여 준다 |
| +num | 시작할 때 num 행부터 보여준다 |
| -d | 내부 명령이 필요할 때 "[Press space to continue, q to quit]" 을 화면 아래에 보여주고, 잘못 입력되었을 때 "[Press h for instructions]"를 보여준다 |
| +/pattern | 패턴을 검색하여 그 위치부터 보여준다 |
| -s | 여러 줄의 빈 줄을 한 줄로 보여준다 | 


## less 명령

`less [options] [filename]`

- 화면 단위로 텍스트 파일의 내용을 보여준다
- more 명령과 다르게 이미 스크롤되어 지나간 내용을 거슬러 올라가 확인하는 것이 기능


## head / tail 명령

`head [options] [files]`
`tail [options] [files]`

- 파일의 처음 혹은 마지막 내용만을 확인하고자 할 때 사용하는 명령
- 기본적으로 10개 라인을 보여주며, -n num 또는 -num 옵션을 사용하여 변경할 수 있다
- tail 명령에 -f 옵션을 사용하면 계속하여 지정된 파일을 감시하며 새로운 라인이 추가될 때마다 즉시 화면에 결과를 보여준다


## cat 명령

`cat [options] [files]`

- 하나의 파일을 출력하거나 여러 파일을 연결시켜 화면에 출력하는 명령
- 여러 파일을 합쳐서 하나의 새로운 파일로 만들려면 입출력 리다이렉션 기호 중 >를 사용
- 기존 파일에 추가하려면 >>를 사용
