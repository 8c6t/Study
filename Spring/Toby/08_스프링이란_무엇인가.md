스프링이란 무엇인가
========

스프링은 단순히 IoC/DI를 편하게 적용하도록 돕는 단계를 넘어서 엔터프라이즈 애플리케이션 개발의 전 영역에 걸쳐 다양한 종류의 기술에 관여한다

## 1. 스프링의 정의

- 자바 엔터프라이즈 개발을 편하게 해주는 오픈소스 경량급 애플리케이션 프레임워크

### 애플리케이션 프레임워크

- 일반적으로 라이븨러리나 프레임워크는 특정 업무 분야나 한 가지 기술에 특화된 목표를 가지고 만들어짐
- 애플리케이션 프레임워크는 특정 계층이나 기술, 업무 분야에 국한되지 않고 애플리케이션의 전 영역을 포괄하는 범용적인 프레임워크를 말함
- 애플리케이션 개발의 전 과정을 빠르고 편리하며 효율적으로 진행하는데 일차적인 목표를 두는 프레임워크
- 스프링의 일차적인 존재목적은 핵심 기술에 담긴 프로그래밍 모델을 일관되게 적용해서 엔터프라이즈 애플리케이션 전 계층과 전 영역에서 전략과 기능을 제공해줌으로써 애플리케이션을 편리하게 개발하게 해주는 애플리케이션 프레임워크로 사용되는 것

### 경량급

- 스프링이 가볍다는 것은 불필요하게 무겁지 않다는 의미
- 서블릿 컨테이너만으로 충분하니 EJB 컨테이너를 비롯한 각종 고급 WAS를 굳이 사용하지 않아도 된다
- 만들어진 코드가 지원하는 기술수준은 비슷하더라도 그것을 훨씬 빠르고 간편하게 작성하게 해줌으로써 생산성과 품질 면에서 유리하다는 것이 바로 경량급이라는 말로 표현되는 스프링의 특징

### 자바 엔터프라이즈 개발을 편하게

- 스프링은 근본적인 부분에서 엔터프라이즈 개발의 복잡함을 제거해내고 진정으로 개발을 편하게 해주는 해결책을 제시
- 엔터프라이즈 개발의 근본적인 문제점에 도전해서 해결책을 제시한다는 것이 기존 기술의 접근 방법과 스프링의 접근 방식의 차이
- 펀리한 애플리케이션 개발이란 개발자가 복잡하고 실수하기 쉬운 로우레벨 기술에 많은 신경을 쓰지 않으면서도 애플리케이션의 핵심인 사용자의 요구사항, 즉 비즈니스 로직을 빠르고 효과적으로 구현하는 것
- EJB는 이 과정에서 다른 차원의 더 큰 복잡함을 애플리케이션 개발에 끌고 들어오는 실수를 저지름
- 엔터프라이즈 개발에서 필연적으로 요구되는 기술적인 요구를 충족하면서도 개발을 복잡하게 만들지 않는다는 점이 스프링의 뛰어난 면

### 오픈소스

- 스프링에 적용된 오픈소스 라이선스는 오픈소스 라이선스 중에서도 비교적 제약이 적고 사용이 매우 자유로운 편인 아파치 라이선스 버전 2.0
- 오픈소스의 장점은 공개된 커뮤니티의 공간 안에서 투명한 방식으로 다양한 참여를 통해 개발되기 때문에 매우 빠르고 유연한 개발이 가능하다는 것
- 지속적이고 안정적인 개발이 계속될지가 불확실하다는 것이 단점
- 스프링은 오픈소스 개발이라는 방법을 선택하기는 했지만 프레임워크 사용자에게 지속적인 신뢰를 줄 수 있도록 개발을 책임지고 진행할 수 있는 전문 기업을 설립하여 운영


## 2. 스프링의 목적

- 어떤 기술이든 그 자체로는 도구에 불과. 그것을 용도에 맞게 잘 활용해서 궁극적으로 이루고자 하는 목표를 이루는 것이 중요
- 자바의 근본적인 목적은 객체지향 프로그래밍을 통해 유연하고 확장성 좋은 애플리케이션을 빠르게 만드는 것
- 경량급 프레임워크인 스프링을 활용해서 엔터프라이즈 애플리케이션 개발을 편하게 하는 것이 목표

### 엔터프라이즈 개발의 복잡함

- 기술적인 제약조건과 요구사항이 늘어가기 때문
  - 엔터프라이즈 시스템이란 서버에서 동작하며 기업과 조직의 업무를 처리해주는 시스템
  - 뛰어난 성능과 서비스의 안정성이 요구되고 그런 점을 고려한 기술이 필요
  - 순수한 비즈니스 로직을 구현하는 것 외에도 기술적으로 고려할 사항이 많다는 뜻
- 엔터프라이즈 애플리케이션이 구현해야 할 핵심기능인 비즈니스 로직의 복잡함이 증가
  - 버그나 오류가 있어서가 아니라, 기능 요구사항과 업무 정책 등이 바뀌기 때문에 애플리케이션을 자주 수정해야 하는 시대가 됨
  - 이전과 다르게 시스템 개발과 유지보수, 추가 개발 등의 작업에 대한 부담이 커지고 그에 따른 개발의 난이도가 증가함

> 성격이 다른 비즈니스 로직의 복잡함과 기술적인 복잡함을 분리해내는 것이 중요


### 비침투적인 방식을 통한 효과적인 해결책: 스프링

- EJB처럼 어떤 기술을 적용했을 때 그 기술과 관련된 코드나 규약 등이 코드에 등장하는 경우를 침투적인 기술이라 함
- 꼭 필요한 기능을 하용하는 것도 아니면서 단지 어떤 기술을 바탕으로 만들어진다고 해서 특정 클래스나 인터페이스, API 등의 코드에 등장한다면 그것은 침투적인 기술이 되어 복잡함을 가중시키는 원인이 됨
- 비침투적인 기술은 기술의 적용 사실이 코드에 직접 반영되지 않는다는 틍징이 있음
- 스프링은 비침투적인 기술이라는 전략을 택해 기술적인 복잡함과 비즈니스 로직을 다루는 코드를 깔끔하게 분리 가능


### 기술적 복잡함을 상대하는 스프링의 전략

- 일관성 없는 기술과 서버환경의 변화에 대한 스프링의 공략 방법은 **서비스 추상화**
- 기술적인 복잡함은 추상화를 통해 로우레벨의 기술 구현 부분과 기술을 사용하는 인터페이스를 분리하고, 환경과 세부 기술에 독립적인 접근 인터페이스를 제공하는 것이 가장 좋은 해결책
- 기술과 비즈니스 로직의 혼재로 발생하는 복잡함을 해결하기 위한 스프링의 접근 방법은 **AOP**
- AOP는 최후까지 애플리케이션 로직을 담당하는 코드에 남아 있는 기술 관련 코드를 깔끔하게 분리해서 별도의 모듈로 관리하게 해주는 강력한 기술


### 비즈니스와 애플리케이션 로직의 복잡함을 상대하는 전략

- 기술적인 코드, 침투적인 기술이 가져온 불필요한 흔적 들을 제거하고 나면 순수하게 애플리케이션의 주요 기능과 비즈니스 로직을 담은 코드만 독립적으로 존재하게 됨
- 과거에는 비즈니스 로직의 상당 부분을 DB에 두는 것이 유행하였음
  - 확장이 힘들고 확장하더라도 많은 비용이 필요
  - 데이터 액세스를 중심으로 로직을 다루면 개발과 유지보수는 물론이고 테스트도 매우 어려움
- 비즈니스 로직은 애플리케이션 안에서 처리하도록 만드는 것이 추세
  - **DB는 단지 데이터의 영구적인 저장과 복잡한 조건을 가진 검색과 같은 자체적으로 특화된 기능에만 활용** 
  - 데이터를 분석하고 가공하고 그에 따라 로직을 처리하는 부분은 확장하기 쉽고, 비용도 저렴한 애플리케이션 서버 쪽으로 이동
- 객체지향 프로그래밍 기법과 언어가 주는 장점인 유연한 설계가 가능하고 재사용성이 높다는 점을 잘 활용하면 자주 바뀌고 조건이 까다로운 비즈니스 로직을 효과적으로 구현할 수 있음


###  핵심 도구: 객체지향과 DI

- 자바의 기본인 객체지향에 충실한 설계가 가능하도록 단순한 오브젝트로 개발할 수 있고, 객체지향의 설계 기법을 잘 적용할 수 있는 구조를 만들기 위해 DI 같은 유용한 기술을 편하게 적용하도록 도와주는 것이 스프링의 기본 전략
- 기술적인 복잡함을 효과적으로 다루게 해주는 기법은 모두 DI를 바탕으로 두고 있음
- DI는 특별한 기술이라기보다는 유연하게 확장할 수 있는 오브젝트 설계를 하다 보면 자연스럽게 적용하게 되는 객체지향 프로그래밍 기법
- 기술적인 복잡함이 비즈니스 로직에 침범하지 못하도록 분리하는 경우에 DI가 바탕이 된 여러 가지 기법이 활용됨
- 비즈니스 로직 자체의 복잡함을 해결하려면 DI보다는 객체지향 설계 기법이 더 중요
  - 순수한 비즈니스 로직만을 담고 있는 코드에는 객체지향 분석과 설계에서 나온 도메인 모델을 쉽게 적용할 수 있기 때문

> 오브젝트 설계 시 ①바뀔 수 있는 것이 무엇인지, ②성격이 다르고, 변경의 이유가 다른 기능은 무엇인지 찾은 뒤 ③DI를 적용해서 오브젝트를 분리하고, ④인터페이스를 도입하고, ⑤DI로 연결한다


## 3. POJO 프로그래밍

- Plain Old Java Object
- 객체지향적인 원리에 충실하면서, 환경과 기술에 종속되지 않고 필요에 따라 재활용될 수 있는 방식으로 설계된 오브젝트를 말함
- 스프링 애플리케이션은 POJO를 이용해서 만든 애플리케이션 코드와, POJO가 어떻게 관계를 맺고 동작하는지를 정의해놓는 설계정보로 구분됨
- DI의 기본 아이디어는 유연하게 확장 가능한 오브젝트를 만들어두고 **그 관계는 외부에서 다이내믹하게 설정해주는 것**


### POJO의 조건

- 특정 규약에 종속되지 않는다
  - 자바 언어와 꼭 필요한 API 외에는 종속되지 않아야 함
- 특정 환경에 종속되지 않는다
  - 비즈니스 로직을 담고 있는 POJO 클래스는 웹이라는 환경정보나 웹 기술을 담고 있는 클래스나 인터페이스를 사용해서는 안 된다(HttpServletRequest, HttpSession, 캐시 관련 API, 웹 프레임워크 클래스 직접 이용 등)
  - 애노테이션이 단지 코드로 표현하기는 적절치 않은 부가적인 정보를 담고 있고, 그 때문에 환경에 종속되지만 않는다면 여전히 POJO라 볼 수 있다
- POJO는 객체지향적인 자바 언어의 기본에 충실하게 만들어져야 한다


### POJO의 장점

- 특정한 기술과 환경에 종속되지 않는 오브젝트는 그만큼 깔끔한 코드가 될 수 있다
- 객체지향적인 설계를 자유롭게 적용할 수 있다


### POJO 프레임워크

- 스프링은 엔터프라이즈 애플리케이션 개발의 모든 영역과 계층에서 POJO 방식의 구현이 가능하게 하려는 목적으로 만들어짐
- 스프링은 비즈니스 로직의 복잡함과 엔터프라이즈 기술의 복잡함을 분리해서 구성할 수 있게 도와주지만, 그 자신은 기술 영역에만 관여할 뿐 비즈니스 로직을 담당하는 POJO에서는 모습을 감춤
- 데이터 액세스 로직이나 웹 UI 로직을 다룰 때만 최소한의 방법으로 관여


## 4. 스프링의 기술

- 스프링에서는 POJO 프로그래밍을 손쉽게 할 수 있도록 지원하는 세 가지 가능기술을 제공
  - IoC/DI, AOP, PSA
- 스프링의 기술들은 스프링 프레임워크가 만들어진 진정한 목표인 POJO 기반의 엔터프라이즈 개발을 편리하게 해주는 도구일 뿐

### IoC/DI

- 유연한 확장을 가능하게 해주는 기술
- DI는 OCP(개방 폐쇄 원칙)에 해당

### DI의 활용 방법

#### 1) 핵심기능의 변경

- 의존 대상의 구현을 바꾸는 것
- 디자인 패턴의 전략 패턴이 대표적인 예

#### 2) 핵심기능의 동적인 변경

- 의존 오브젝트의 핵심기능 자체를 바꾸는 것
- DI를 잘 활용하면 애플리케이션이 동작하는 중간에 그 의존 대상을 다이내믹하게 변경할 수 있음
- 동적인 방식으로 핵심 기능을 변경하는 건, 기술적으로 보면 다이내믹 라우팅 프록시나 프록시 오브젝트 기법을 활용한 것

#### 3) 부가기능의 추가

- 핵심 가능은 그대로 둔 채 부가기능을 추가하는 것
- 디자인 패턴의 데코레이션 패턴
- 부가기능의 추가 방식을 특정 오브젝트가 아니라 좀 더 많은 대상으로 일반화해서 적용하면 AOP가 된다

#### 4) 인터페이스의 변경

- 인터페이스가 다른 오브젝트를 클라이언트가 사용하는 인터페이스로 바꾸어주는 기능
- 디자인 패턴의 어댑터 패턴
- DI의 응용 방법 중 하나이자 스프링의 대뵤적인 기술로도 분류되는 일관성 있는 서비스 추상화가 대표적인 예
  - 클라이언트가 일관성 있게 사용할 수 있는 인터페이스를 정의해주고 DI를 통해 어댑터 역할을 하는 오브젝트를 이용하게 함

#### 5) 프록시

- 지연된 로딩(lazy loading), 원격 프록시 기술
- 디자인 패턴의 프록시 패턴
- 스프링은 EJB 원격 호출을 포함해서 웹 서비스, REST 호출, HTTP 방식의 호출 등 다양한 리모팅 기술을 지원

#### 6) 템플릿과 콜백

- 반복적으로 등장하지만 항상 고정적인 작업 흐름과 그 사이에서 자주 바뀌는 부분을 분리해서 템플릿과 콜백으로 만든 뒤, 이를 DI 원리를 응용하여 적용
- 콜백을 템플릿에 주입하는 방식으로 동작하게 하는 것은 DI의 원리에 가장 충실한 응용 방법

#### 7) 싱글톤과 오브젝트 스코프

- DI 대상 오브젝트를 컨테이너가 관리함으로서 DI 할 오브젝트의 생명주기를 제어할 수 있다
- 전통적인 싱글톤 패턴은 오브젝트에 많은 제약을 가해서 만들어지므로 권장되지 않으므로 컨테이너가 오브젝트를 관리하는 IoC 방식이 유용
- 스프링에서는 싱글톤 외에도 다양한 스코프를 갖는 오브젝트를 만들어 DI에 사용할 수도 있음

#### 8) 테스트

- 여타 오브젝트와 협력해서 동작하는 오브젝트를 효과적으로 테스트하는 방법은 가능한 한 고립시키는 것
- 의존 오브젝트를 대신해서 스텁 또는 목 오브젝트 같은 테스트 대역을 활용해야 함
- DI를 위해 만든 수정자 메소드를 사용하면 테스트 코드 안에서 수동으로 목 오브젝트 주입이 가능
- 또는 테스트용으로 설정을 별도로 만들 수도 있다


### AOP

- Aspect Oriented Programming
- AOP는 객체지향 기술의 한계와 단점을 극복하도록 도와주는 보조적인 프로그래밍 기술
- 일부 서비스는 순수한 객체지향 기법만으로는 POJO의 조건을 유지한 채로 적용하기 힘들기에, AOP가 필요
- 스프링은 기본적으로 다이내믹 프록시를 사용하여 AOP를 구현하며, 별도의 컴파일러나 클래스 로더를 이용하여 코드를 조작하는 형태의 AOP도 존재(AspectJ)
- AOP는 하나의 모듈이 수많은 오브젝트에 보이지 않게 적용되기 때문에 매우 주의해서 사용해야 한다


### PSA

- Portable Service Abstraction
- 환경과 세부 기술의 변화에 관계 없이 일관된 방식으로 기술에 접근할 수 있도록 하는 기술
- 특정 환경과 기술에 종속적이지 않다는 게 그런 기술을 사용하지 않는다는 뜻은 아님
- POJO 코드가 그런 기술에 직접 노출되어 만들어지지 않았다는 것을 의미
- 스프링의 서비스 추상화의 개념과 장점을 잘 이해한다면 때에 따라 직접 서비스 추상화 기법을 적용할 필요도 있음
